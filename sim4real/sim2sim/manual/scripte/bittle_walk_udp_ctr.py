

import copy

import numpy as np
numFramevt = 39
vetVt = np.array([
    # [57, 43, 60, 47, -18, 7, -17, 7],
    # [50, 43, 53, 47, -5, 7, -5, 7],
    # [43, 43, 47, 47, 7, 7, 7, 7],
    # [43, 43, 47, 47, 7, 7, 7, 7],
    # [43, 43, 47, 47, 7, 7, 7, 7],
    # [43, 47, 47, 50, 7, 0, 7, 0],
    # [43, 54, 47, 58, 7, -13, 7, -13],
    # [43, 60, 47, 65, 7, -25, 7, -25],
    # [43, 66, 47, 71, 7, -35, 7, -35],
    # [43, 63, 47, 67, 7, -30, 7, -29],#10
    # [43, 57, 47, 60, 7, -18, 7, -17],
    # [43, 50, 47, 53, 7, -5, 7, -5],
    # [43, 43, 47, 47, 7, 7, 7, 7],
    # [43, 43, 47, 47, 7, 7, 7, 7],
    # [43, 43, 47, 47, 7, 7, 7, 7],
    # [43, 43, 47, 47, 7, 7, 7, 7],
    # [47, 43, 50, 47, 0, 7, 0, 7],
    # [54, 43, 58, 47, -13, 7, -13, 7],
    # [60, 43, 65, 47, -25, 7, -25, 7],
    # [66, 43, 71, 47, -35, 7, -35, 7],
   # [63, 43, 67, 47, -30, 7, -29, 7],
  [18,  54,  58,  52,   7,  13,  -2,   9],
  [14,  56,  52,  54,  12,  14,  -3,  10],
  [15,  57,  46,  55,  17,  15,  -4,  11],
  [16,  58,  38,  57,  16,  17,  -2,  12],
  [19,  59,  31,  58,  13,  19,   1,  14],
  [22,  59,  24,  60,  12,  22,   6,  14],
  [26,  60,  21,  61,  10,  24,  12,  16],
  [28,  58,  23,  62,   9,  30,  16,  18],
  [31,  61,  25,  63,   8,  30,  13,  20],
  [34,  67,  28,  63,   7,  23,  12,  24],
  [36,  69,  31,  63,   6,  15,  11,  27],
  [38,  68,  34,  63,   7,   8,  10,  31],
  [41,  65,  36,  62,   7,   3,   9,  35],
  [43,  60,  39,  65,   7,  -1,   9,  37],
  [46,  55,  41,  70,   7,  -3,   9,  27],
  [47,  50,  43,  71,   7,  -5,   9,  23],
  [49,  43,  47,  71,   8,  -5,   7,  14],
  [51,  35,  48,  69,   8,  -3,   8,   8],
  [53,  28,  51,  66,   9,   1,   8,   2],
  [54,  18,  52,  63,  12,   7,   9,  -2],
  [55,  15,  54,  56,  14,  10,  10,  -3],
  [56,  13,  55,  51,  15,  16,  11,  -4],
  [57,  16,  57,  43,  17,  16,  12,  -3],
  [58,  18,  58,  36,  19,  14,  14,  -2],
  [59,  21,  60,  28,  21,  12,  14,   2],
  [60,  25,  61,  23,  24,  10,  16,   9],
  [60,  28,  62,  22,  27,   9,  18,  15],
  [60,  31,  63,  23,  30,   8,  20,  16],
  [66,  32,  63,  26,  24,   7,  24,  13],
  [68,  35,  63,  29,  19,   6,  27,  11],
  [68,  38,  63,  32,  10,   6,  31,  10],
  [66,  40,  62,  35,   4,   7,  35,  10],
  [62,  42,  65,  37,   0,   7,  37,   9],
  [57,  45,  70,  39,  -2,   7,  27,   9],
  [52,  47,  71,  41,  -5,   7,  23,   9],
  [45,  48,  71,  44,  -5,   8,  14,   9],
  [38,  51,  69,  47,  -3,   8,   8,   7],
  [30,  52,  66,  49,  -1,   9,   2,   8],
  [22,  53,  63,  51,   4,  12,  -2,   8],
],dtype=np.float64)

import random
import socket
import time

dest_addr = ('127.0.0.1', 8080)  # 服务端地址和端口
udp_socket = socket.socket(socket.AF_INET, socket.SOCK_DGRAM)

#Init
j=0
vectorPre = np.array([30, -30, -30, 30, 30, -30, -30, 30])
vectorPre =vectorPre/180*3.14
numFrame = numFramevt
vecTarget = vetVt
timeUpdate = 1/60

while True:
    i = j % numFrame
    vecCur = copy.deepcopy(vecTarget[i])
    # vecCur[4] += -90.0
    # vecCur[5] = 90.0 - vecCur[5]
    # vecCur[6] = 90.0 - vecCur[6]
    # vecCur[7] += -90.0

    vecCur[1] = -vecCur[1]
    vecCur[2] = -vecCur[2]
    vecCur[5] = -vecCur[5]
    vecCur[6] = -vecCur[6]
    vecCur = vecCur/180*3.14
    stepSmooth = 1
    for k in range(stepSmooth):
        diff = vecCur - vectorPre
        vecOut = vectorPre + (k+1)/stepSmooth * diff
        vectorPre = vecOut
        #strVec = ','.join(str(i) for i in vecOut)
        #print(vecOut.tostring())
        udp_socket.sendto(vecOut.tostring(),dest_addr)
        time.sleep(timeUpdate)
    j  = j + 1

udp_socket.close()
